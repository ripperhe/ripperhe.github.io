<!DOCTYPE html>
<html lang="en-us">
  
  <head>
  <meta charset="UTF-8">
  <title>Run Faster</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">Run Faster</h1>
  <h2 class="project-tagline">Learn from yesterday, live for today, look to tomorrow.</h2>
  <a href="http://localhost:4000" class="btn">Home</a>
  <a href="http://github.com/ripperhe" class="btn">GitHub</a>
  <a href="https://twitter.com/ripper_he" class="btn">Twitter</a>
  <a href="http://weibo.com/2244381941/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" class="btn">WeiBo</a>
  <a href="http://www.jianshu.com/users/b9249fb85d5d/latest_articles" class="btn">JianShu</a>
</section>


    <section class="main-content">
      
      <h1 id="ios-uiwindow">iOS UIWindowåŠæ‚¬æµ®çƒ</h1>

<p><img src="http://upload-images.jianshu.io/upload_images/939125-37108f75b88c3a3a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UIWindow" /></p>
<h4 id="uiwindow">1.UIWindowç®€ä»‹</h4>

<p>ä¸€ä¸ª<strong>UIWindow</strong>å¯¹è±¡ä¸ºåº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢æä¾›äº†èƒŒæ™¯ä»¥åŠé‡è¦çš„äº‹ä»¶å¤„ç†è¡Œä¸ºã€‚
UIWindowç»§æ‰¿è‡ªUIViewï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç›´æ¥å»è®¾ç½®å…¶UIå±•ç°ï¼Œä½†å®ƒå¯¹å±•ç°ç¨‹åºä¸­çš„viewsè‡³å…³é‡è¦ã€‚æ¯ä¸€ä¸ªviewï¼Œæƒ³è¦å‡ºç°åœ¨å±å¹•ä¸Šéƒ½ä¾èµ–äºwindowï¼Œä½†æ˜¯ç¨‹åºä¸­çš„windowä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚åº”ç”¨ç¨‹åºæ”¶åˆ°äº‹ä»¶ä¹‹åä¼šå…ˆè½¬å‘ç»™é€‚å½“çš„windowå¯¹è±¡ï¼Œä»è€Œåˆå°†äº‹ä»¶è½¬å‘ç»™viewå¯¹è±¡ã€‚</p>

<h4 id="uiwindow-1">2.ç¨‹åºä¸­æœ‰å“ªäº›UIWindow</h4>

<p>æ‰€æœ‰viewçš„å±•ç°éƒ½ä¾èµ–äºwindowï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„iOSå·¥ç¨‹ï¼Œå°†å…¶è¿è¡Œä¼šæ‰§è¡Œä»¥ä¸‹äº‹æƒ…</p>

<ul>
  <li>Xcodeä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªwindowï¼Œå³<code class="highlighter-rouge">app delegate</code>ä¸­çš„windowå±æ€§ã€‚</li>
  <li>åŒæ—¶,Xcodeä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªMain.storyboard,å…¶<code class="highlighter-rouge">instantiateInitialViewController</code>çš„æ˜¾ç¤ºéœ€è¦windowï¼Œä¾èµ–çš„å³ä¸ºå‰é¢çš„windowã€‚</li>
  <li>æ­¤æ—¶ï¼Œè¯¥windowçš„<code class="highlighter-rouge">rootViewController</code>å³ä¸ºMain.storyboardçš„<code class="highlighter-rouge">instantiateInitialViewController</code>ã€‚</li>
</ul>

<p>å¾ˆæ˜¾ç„¶ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºå½“ä¸­ï¼Œä¸æ˜¯åªèƒ½æœ‰ä¸€ä¸ªwindowï¼Œå¯ä»¥å­˜åœ¨å¤šä¸ªwindowã€‚å·²çŸ¥çš„æœ‰ä»¥ä¸‹windowï¼š</p>

<ul>
  <li>app delegateé‡Œçš„window</li>
  <li>çŠ¶æ€æ çš„windowï¼ˆæ¯”è¾ƒç‰¹æ®Šï¼Œè™½ç„¶åœ¨ç¨‹åºå†…éƒ¨å¯ä»¥è°ƒç”¨æŸäº›apiæ˜¾ç¤ºéšè—æˆ–æ”¹å˜å…¶UIï¼Œä½†å®ƒçš„windowæ˜¯ä¸è¢«æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå†…éƒ¨æ‰€æŒæœ‰çš„ï¼‰</li>
  <li>é”®ç›˜çš„window</li>
</ul>

<h4 id="uiwindow-2">3.è·å–ç¨‹åºä¸­çš„UIWindow</h4>
<p><code class="highlighter-rouge">UIApplication</code>è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œé€šè¿‡å…¶<strong>sharedApplication</strong>æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œä¸€ä¸ªç¨‹åºå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªUIApplicationå¯¹è±¡,å¯ä»¥é€šè¿‡UIApplicationå¯¹è±¡çš„ä»¥ä¸‹å±æ€§æ¥è·å–æƒ³è¦çš„windowã€‚</p>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span><span class="p">(</span><span class="n">nullable</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">,</span><span class="n">readonly</span><span class="p">)</span> <span class="n">UIWindow</span> <span class="o">*</span><span class="n">keyWindow</span><span class="p">;</span>
<span class="k">@property</span><span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">readonly</span><span class="p">)</span> <span class="n">NSArray</span><span class="o">&lt;</span><span class="n">__kindof</span> <span class="n">UIWindow</span> <span class="o">*&gt;</span>  <span class="o">*</span><span class="n">windows</span><span class="p">;</span>
</code></pre>
</div>

<p><strong>keyWindow</strong> åº”ç”¨ç¨‹åºçš„å…³é”®windowã€‚ç”¨æ¥æ¥æ”¶é”®ç›˜ä»¥åŠéè§¦æ‘¸ç±»çš„æ¶ˆæ¯äº‹ä»¶çš„UIWindowï¼Œè€Œä¸”ç¨‹åºä¸­æ¯ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªUIWindowæ˜¯keyWindowã€‚					
<strong>windows</strong> åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰çš„windowå¯¹è±¡ï¼ŒåŒ…æ‹¬æ­£åœ¨æ˜¾ç¤ºçš„æˆ–éšè—çš„windowã€‚</p>

<p>æ–°å»ºä¸€ä¸ªiOSå·¥ç¨‹,åœ¨æ²¡æœ‰è§¦å‘é”®ç›˜æ—¶ï¼Œåœ¨æ§åˆ¶å°æ‰“å°<code class="highlighter-rouge">winodws</code>å¦‚ä¸‹ï¼š</p>
<blockquote>
  <p>(lldb) po [[UIApplication sharedApplication] windows]  <br />
&lt;__NSArrayM 0x61800024d7d0&gt;(  <br />
&lt;<strong>UIWindow</strong>: 0x7fd8e1a06370; frame = (0 0; 414 736); autoresize = W+H; gestureRecognizers = &lt;NSArray: 0x61800024d170&gt;; layer = &lt;UIWindowLayer: 0x61000003e7c0Â»  <br />
)</p>
</blockquote>

<p>è¯¥windowå°±æ˜¯ app delegate çš„windowï¼Œå³ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„é‚£ä¸ªwindowã€‚å½“æ–‡æœ¬ç¼–è¾‘ï¼Œè§¦å‘é”®ç›˜ä¹‹åï¼Œæ‰“å°<code class="highlighter-rouge">windows</code>å¦‚ä¸‹ï¼š</p>
<blockquote>
  <p>(lldb) po [[UIApplication sharedApplication] windows]  <br />
&lt;__NSArrayM 0x61000005d1f0&gt;( <br />
&lt;<strong>UIWindow</strong>: 0x7fd8e1a06370; frame = (0 0; 414 736); autoresize = W+H; gestureRecognizers = &lt;NSArray: 0x61800024d170&gt;; layer = &lt;UIWindowLayer: 0x61000003e7c0Â»,   <br />
&lt;<strong>UITextEffectsWindow</strong>: 0x7fd8dfc1cde0; frame = (0 0; 414 736); opaque = NO; autoresize = W+H; layer = &lt;UIWindowLayer: 0x60800022dd60Â»,      <br />
&lt;<strong>UIRemoteKeyboardWindow</strong>: 0x7fd8dfc27e40; frame = (0 0; 414 736); opaque = NO; autoresize = W+H; layer = &lt;UIWindowLayer: 0x608000231300Â» <br />
)</p>
</blockquote>

<p>æ‰“å°ä¸­çš„<code class="highlighter-rouge">UIRemoteKeyboardWindow</code>å°±æ˜¯é”®ç›˜çš„windowï¼Œä¸æ­¤åŒæ—¶ï¼Œè¿˜å‡ºç°äº†<code class="highlighter-rouge">UITextEffectsWindow</code>ï¼Œè¿™ä¸ªwindowæˆ‘æ²¡æœ‰æ‰¾åˆ°å®˜æ–¹çš„è¯´æ˜ï¼Œä¸è¿‡å¯ä»¥æ¨æµ‹å®ƒä¹Ÿæ˜¯å’Œæ–‡æœ¬è¾“å…¥æœ‰å…³ç³»çš„ã€‚</p>

<h4 id="uiwindow-3">4.UIWindowçš„å±æ€§ä¸æ–¹æ³•</h4>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span><span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">strong</span><span class="p">)</span> <span class="n">UIScreen</span> <span class="o">*</span><span class="n">screen</span>
</code></pre>
</div>
<p>è¯¥å±æ€§é»˜è®¤ä¸º<code class="highlighter-rouge">[UIScreen mainScreen]</code>ï¼Œä¸€ä¸ª<code class="highlighter-rouge">UIScreen</code>å¯¹è±¡å¯¹åº”ä¸€ä¸ªå®é™…è®¾å¤‡çš„ç‰©ç†å±å¹•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹å…¶è¿›è¡Œè®¾ç½®ã€‚ä¸€ä¸ªiPhoneé»˜è®¤ä¹Ÿå°±ä¸€ä¸ªå±å¹•ï¼Œä¸€ä¸ªå±å¹•å¯ä»¥å­˜åœ¨å¤šä¸ªwindowï¼Œé‚£ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€ä¸ªç¨‹åºé‡Œé¢å¯ä»¥æœ‰å¤šä¸ªwindowçš„åŸå› ã€‚</p>

<p>å½“ä¸€ä¸ªiPhoneè¿æ¥ä¸€ä¸ªå¤–æ¥å±å¹•çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šå‘é€é€šçŸ¥ã€‚ç„¶è€Œå¦‚æœæˆ‘ä»¬ä»€ä¹ˆéƒ½ä¸åšï¼Œå¤–æ¥å±å¹•ä¼šä¸€ç‰‡æ¼†é»‘ï¼Œå› ä¸ºåœ¨é‚£ä¸ªå±å¹•ä¸Šä¸å­˜åœ¨ä»»ä½•windowå¯¹è±¡ã€‚å¦‚æœçœŸçš„æƒ³è¦åœ¨å¤–æ¥çš„å±å¹•ä¸­æ˜¾ç¤ºä¸€äº›ä¸œè¥¿çš„è¯ï¼Œé‚£å°±åº”è¯¥ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼Œåœ¨æ¥æ”¶é€šçŸ¥çš„æ–¹æ³•é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„windowï¼Œå¹¶å°†å…¶æ˜¾ç¤ºï¼Œå½“ç„¶ï¼Œæ–­å¼€è¿æ¥çš„æ—¶å€™ï¼Œåº”è¯¥å°†windowå¯¹è±¡ç½®ä¸ºnilé‡Šæ”¾ã€‚ä»¥ä¸‹ä¸ºå®˜æ–¹ç¤ºä¾‹ä»£ç ï¼š</p>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">handleScreenConnectNotification</span><span class="p">:(</span><span class="n">NSNotification</span><span class="o">*</span><span class="p">)</span><span class="nv">aNotification</span> <span class="p">{</span>
    <span class="n">UIScreen</span><span class="o">*</span>    <span class="n">newScreen</span> <span class="o">=</span> <span class="p">[</span><span class="n">aNotification</span> <span class="nf">object</span><span class="p">];</span>
    <span class="n">CGRect</span>        <span class="n">screenBounds</span> <span class="o">=</span> <span class="n">newScreen</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
 
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">_secondWindow</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_secondWindow</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIWindow</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFrame</span><span class="p">:</span><span class="n">screenBounds</span><span class="p">];</span>
        <span class="n">_secondWindow</span><span class="p">.</span><span class="n">screen</span> <span class="o">=</span> <span class="n">newScreen</span><span class="p">;</span>
 
        <span class="c1">// Set the initial UI for the window and show it.
</span>        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">viewController</span> <span class="nf">displaySelectionInSecondaryWindow</span><span class="p">:</span><span class="n">_secondWindow</span><span class="p">];</span>
        <span class="p">[</span><span class="n">_secondWindow</span> <span class="nf">makeKeyAndVisible</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">handleScreenDisconnectNotification</span><span class="p">:(</span><span class="n">NSNotification</span><span class="o">*</span><span class="p">)</span><span class="nv">aNotification</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_secondWindow</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Hide and then delete the window.
</span>        <span class="n">_secondWindow</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
        <span class="p">[</span><span class="n">_secondWindow</span> <span class="nf">release</span><span class="p">];</span>
        <span class="n">_secondWindow</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
 
        <span class="c1">// Update the main screen based on what is showing here.
</span>        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">viewController</span> <span class="nf">displaySelectionOnMainScreen</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span><span class="p">(</span><span class="n">nonatomic</span><span class="p">)</span> <span class="n">UIWindowLevel</span> <span class="n">windowLevel</span><span class="p">;</span>
</code></pre>
</div>
<p>windowç­‰çº§ï¼Œå³windowåœ¨zè½´ä¸Šçš„å±‚çº§å…³ç³»,é»˜è®¤æ˜¯0ã€‚<code class="highlighter-rouge">UIWindowLevel</code>æœ¬èº«æ˜¯ä¸€ä¸ª<code class="highlighter-rouge">CGFloat</code>ç±»å‹,å¯ä»¥éšæ„è®¾ç½®æˆ–è¿›è¡ŒåŠ å‡ï¼Œé«˜ç­‰çº§ä¼šæ˜¾ç¤ºåœ¨ä½ç­‰çº§ä¸Šé¢ã€‚ç³»ç»Ÿç»™å‡ºäº†ä¸‰ç§å¸¸ç”¨ç­‰çº§:</p>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="n">UIKIT_EXTERN</span> <span class="k">const</span> <span class="n">UIWindowLevel</span> <span class="n">UIWindowLevelNormal</span><span class="p">;</span>      <span class="mi">0</span>
<span class="n">UIKIT_EXTERN</span> <span class="k">const</span> <span class="n">UIWindowLevel</span> <span class="n">UIWindowLevelAlert</span><span class="p">;</span>       <span class="mi">2000</span>
<span class="n">UIKIT_EXTERN</span> <span class="k">const</span> <span class="n">UIWindowLevel</span> <span class="n">UIWindowLevelStatusBar</span><span class="p">;</span>   <span class="mi">4000</span>
</code></pre>
</div>
<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span><span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">readonly</span><span class="p">,</span><span class="n">getter</span><span class="o">=</span><span class="n">isKeyWindow</span><span class="p">)</span> <span class="n">BOOL</span> <span class="n">keyWindow</span><span class="p">;</span>
</code></pre>
</div>
<p>å½“å‰windowå¯¹è±¡æ˜¯å¦ä¸ºç¨‹åºçš„keyWindowï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨èµ‹å€¼æ›´æ–°ï¼Œæˆ‘ä»¬ä¸éœ€è¦ï¼Œä¹Ÿä¸èƒ½æ‰‹åŠ¨è®¾ç½®ã€‚</p>

<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">becomeKeyWindow</span><span class="p">;</span><span class="c1">// override point for subclass. Do not call directly
</span><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">resignKeyWindow</span><span class="p">;</span><span class="c1">// override point for subclass. Do not call directly
</span></code></pre>
</div>
<p>è¿™ä¸ªæ˜¯åœ¨ç»§æ‰¿çš„æ—¶å€™è¿›è¡Œé‡å†™çš„ï¼Œä¸è¦æ‰‹åŠ¨å»è°ƒç”¨ã€‚åœ¨ä¸€ä¸ªwindowçš„keyWindowå±æ€§æ”¹å˜æ—¶ä¼šè°ƒç”¨ï¼Œå½“ä½ å†™ä¸€ä¸ªå­ç±»ç»§æ‰¿UIWindow,å¦‚æœéœ€è¦åœ¨windowå˜æˆkeyWindow,æˆ–æ˜¯keyWinowå˜ä¸ºNOçš„æ—¶å€™æƒ³åšä¸€äº›äº‹æƒ…ï¼Œå°±å¯ä»¥é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä»¥ä¸‹ä¸ºå®˜æ–¹è§£é‡Šã€‚</p>
<blockquote>
  <p>You should rarely need to subclass UIWindow. The kinds of behaviors you might implement in a window can usually be implemented in a higher-level view controller more easily. One of the few times you might want to subclass is to override the becomeKeyWindow or resignKeyWindow methods to implement custom behaviors when a windowâ€™s key status changes.</p>
</blockquote>

<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">makeKeyWindow</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">makeKeyAndVisible</span><span class="p">;</span>
</code></pre>
</div>
<p>ä¸€ä¸ªwindowçš„hideenå±æ€§é»˜è®¤æ˜¯YESçš„ï¼Œ<code class="highlighter-rouge">makeKeyWindow</code>æ˜¯å°†ä¸€ä¸ªwindowè®¾ç½®ä¸ºkeyWindowï¼Œä½†æ˜¯<code class="highlighter-rouge">makeKeyAndVisible</code>ä¼šå°†ä¸€ä¸ªwindowè®¾ç½®ä¸ºkeyWindowå¹¶å°†å…¶æ˜¾ç¤ºã€‚å¦‚ä½•æ²¡æœ‰å˜æˆkeyWindow,åˆ™å…¶å†…éƒ¨çš„æ–‡æœ¬æ¡†æ²¡æ³•è¾“å…¥æ–‡å­—ã€‚</p>

<blockquote>
  <p>UIWindow: 0x12dd3ef20; frame = (0 200; 200 200); hidden = YES; gestureRecognizers = &lt;NSArray: 0x12dd40530&gt;; layer = &lt;UIWindowLayer: 0x12dd3f230&gt;  <br />
UIWindow: 0x12dd3ef20; frame = (0 200; 200 200); gestureRecognizers = &lt;NSArray: 0x12dd40530&gt;; layer = &lt;UIWindowLayer: 0x12dd3f230&gt;</p>
</blockquote>

<p>ä»¥ä¸Šä¸ºå°†ä¸€ä¸ªwindowè°ƒç”¨<code class="highlighter-rouge">makeKeyAndVisible</code>å‰åå¯¹æ¯”ï¼Œå¯ä»¥å‘ç°ï¼Œå…¶hiddenä»YESå˜ä¸ºNOã€‚æ‰€ä»¥æŸä¸ªwindowè°ƒç”¨<code class="highlighter-rouge">makeKeyAndVisible</code>ä¹‹åï¼Œç³»ç»Ÿå¯¹è¯¥windowè‡³å°‘åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š</p>

<ul>
  <li>å°†UIApplicationå¯¹è±¡çš„keyWindowè®¾ç½®ä¸ºå½“å‰è¿™ä¸ªwindow</li>
  <li>å½“å‰windowçš„<code class="highlighter-rouge">hidden</code>è®¾ç½®ä¸ºNOï¼ŒåŒæ—¶è¯¥windowçš„keyWindowå±æ€§å˜ä¸ºYES</li>
</ul>

<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span><span class="p">(</span><span class="n">nullable</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">,</span><span class="n">strong</span><span class="p">)</span> <span class="n">UIViewController</span> <span class="o">*</span><span class="n">rootViewController</span><span class="p">;</span>
</code></pre>
</div>
<p>è¯¥å±æ€§ä¸ºwindowçš„æ ¹æ§åˆ¶å™¨ï¼Œç°åœ¨è¿™ä¸ªå±æ€§æ˜¯ä¸èƒ½ä¸ºç©ºçš„ï¼Œå¿…é¡»è¿›è¡Œèµ‹å€¼ï¼Œå¦åˆ™ç¨‹åºä¼šå´©æºƒã€‚</p>

<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">sendEvent</span><span class="p">:(</span><span class="n">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span><span class="p">;</span>
</code></pre>
</div>
<p>æœ‰äº‹ä»¶éœ€è¦å¤„ç†çš„æ—¶å€™UIApplicationä¼šè°ƒç”¨è¯¥æ–¹æ³•æ´¾å‘äº‹ä»¶ã€‚</p>

<hr />
<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nf">convertPoint</span><span class="p">:(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nv">point</span> <span class="nf">toWindow</span><span class="p">:(</span><span class="n">nullable</span> <span class="n">UIWindow</span> <span class="o">*</span><span class="p">)</span><span class="nv">window</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nf">convertPoint</span><span class="p">:(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nv">point</span> <span class="nf">fromWindow</span><span class="p">:(</span><span class="n">nullable</span> <span class="n">UIWindow</span> <span class="o">*</span><span class="p">)</span><span class="nv">window</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="n">CGRect</span><span class="p">)</span><span class="nf">convertRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span> <span class="nf">toWindow</span><span class="p">:(</span><span class="n">nullable</span> <span class="n">UIWindow</span> <span class="o">*</span><span class="p">)</span><span class="nv">window</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="n">CGRect</span><span class="p">)</span><span class="nf">convertRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span> <span class="nf">fromWindow</span><span class="p">:(</span><span class="n">nullable</span> <span class="n">UIWindow</span> <span class="o">*</span><span class="p">)</span><span class="nv">window</span><span class="p">;</span>
</code></pre>
</div>
<p>windowä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¦‚æœæƒ³è¦å°†ä¸¤ä¸ªwindowçš„åæ ‡ç›¸äº’æ˜ å°„çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°ä»¥ä¸Šå‡ ä¸ªæ–¹æ³•ã€‚</p>

<h4 id="uiwindow-4">5.å¦‚ä½•åˆ›å»ºä¸€ä¸ªUIWindowå¹¶æ˜¾ç¤º</h4>

<p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<blockquote>
  <ol>
    <li>åˆ›å»ºä¸€ä¸ªwindowå¯¹è±¡ï¼Œå¹¶ç”¨ä¸€ä¸ªå¯¹è±¡<strong>å¼ºæŒæœ‰</strong>å®ƒ</li>
    <li>åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ï¼Œèµ‹å€¼ä¸ºwindowçš„æ ¹æ§åˆ¶å™¨</li>
    <li>æ˜¾ç¤ºçª—å£</li>
  </ol>
</blockquote>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="c1">//1. åˆ›å»ºä¸€ä¸ªwindowå¯¹è±¡ï¼Œå¹¶ç”¨ä¸€ä¸ªå¯¹è±¡å¼ºæŒæœ‰å®ƒ
</span><span class="n">UIWindow</span> <span class="o">*</span><span class="n">testWindow</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIWindow</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFrame</span><span class="p">:[</span><span class="n">UIScreen</span> <span class="nf">mainScreen</span><span class="p">].</span><span class="n">bounds</span><span class="p">];</span>
<span class="n">self</span><span class="p">.</span><span class="n">testWindow</span> <span class="o">=</span> <span class="n">testWindow</span><span class="p">;</span>
<span class="c1">//2. åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ï¼Œèµ‹å€¼ä¸ºwindowçš„æ ¹æ§åˆ¶å™¨
</span><span class="n">UIViewController</span> <span class="o">*</span><span class="n">controller</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">testWindow</span><span class="p">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">controller</span><span class="p">;</span>
<span class="c1">//3. æ˜¾ç¤ºçª—å£
</span><span class="p">[</span><span class="n">testWindow</span> <span class="nf">makeKeyAndVisible</span><span class="p">];</span>
</code></pre>
</div>
<p>è¿™é‡Œï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼š</p>

<ul>
  <li>windowçš„frameå†³å®šäº†è¿™ä¸ªçª—å£å¤§å°ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œè®¾ç½®</li>
  <li>æ–°çš„æ§åˆ¶å™¨ä¹‹æ‰€ä»¥èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œæ˜¯å› ä¸ºwindowå¼ºæŒæœ‰å®ƒï¼Œwindowèƒ½æ­£å¸¸è¿è¡Œï¼Œåˆ™æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªæš‚æ—¶ä¸ä¼šé”€æ¯çš„å¯¹è±¡å¼ºæŒæœ‰windowï¼ˆå½“ç„¶ï¼Œç›´æ¥ç”¨ä¸€ä¸ªé™æ€å˜é‡æŒæœ‰ä¹Ÿå¯ä»¥ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼‰ã€‚</li>
  <li>å¦‚æœwindowçœ‹ä¸è§ï¼Œå¯ä»¥è¯•è¯•ä¿®æ”¹ä»¥ä¸‹å…¶<code class="highlighter-rouge">windowLevel</code>å±æ€§ã€‚é«˜ç­‰çº§çš„windowä¸€å®šä¼šæ˜¾ç¤ºåœ¨ä½ç­‰çº§çš„windowä¸Šé¢ï¼ŒåŒç­‰çº§çš„window,åmakeKeyWindowçš„windowå°±ä¼šæ˜¾ç¤ºåœ¨ä¸Šé¢ã€‚</li>
  <li>æ— è®ºæ˜¯é€šè¿‡ä»£ç ,storyboardæˆ–xibåˆå§‹åŒ–ä¸€ä¸ªæ§åˆ¶å™¨æ¥æ˜¾ç¤ºï¼Œéƒ½æ˜¯ä»¥ä¸Šä¸‰æ­¥ï¼Œåªæ˜¯åˆ›å»ºæ§åˆ¶å™¨çš„æ–¹æ³•æœ‰æ‰€åŒºåˆ«ç½¢äº†ï¼Œè¿™é‡Œä¸åšè®¨è®ºäº†ã€‚</li>
</ul>

<h4 id="uiwindow-5">6.å¦‚ä½•é”€æ¯ä¸€ä¸ªUIWindow</h4>

<p>å‰é¢å·²ç»è¯´è¿‡ï¼Œå¯¹äºä¸€ä¸ªUIWindowå¯¹è±¡ï¼Œä¹‹æ‰€ä»¥æ˜¾ç¤ºï¼Œæ˜¯å› ä¸ºæœ‰ä¸€ä¸ªå¯¹è±¡å¼ºæŒæœ‰å®ƒï¼Œè¦é”€æ¯ä¸€ä¸ªwindowï¼Œåªéœ€è¦å°†è¿™ä¸ªå¼ºæŒæœ‰å»æ‰å³å¯ã€‚ä½†æ˜¯,è¿™ç§æŒæœ‰å»æ‰ä¹‹åï¼Œå¯èƒ½windowå¯èƒ½ä¸ä¼šç«‹å³æ¶ˆå¤±ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†ç¡®ä¿èƒ½å¤Ÿç«‹å³å°†å…¶ä¸å±•ç°ï¼Œæœ€å¥½æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<blockquote>
  <ol>
    <li>å°†windowçš„hiddenå±æ€§ç½®ä¸ºYES</li>
    <li>å°†æŒæœ‰è¯¥windowçš„é‚£ä¸ªå¯¹è±¡å¯¹windowçš„æŒæœ‰å»æ‰ï¼ˆæœ‰ç‚¹ç»•ğŸ˜„ï¼‰</li>
  </ol>
</blockquote>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-objc highlighter-rouge"><pre class="highlight"><code><span class="n">self</span><span class="p">.</span><span class="n">testWindow</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
<span class="n">self</span><span class="p">.</span><span class="n">testWindow</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</code></pre>
</div>
<p>å‡å¦‚å½“å‰è¿™ä¸ªwindowæ˜¯keyWindowï¼Œè¿™ä¸ªwindowè¢«é”€æ¯ä¹‹åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†ä¸Šä¸€ä¸ªkeyWindowè®¾ç½®ä¸ºkeyWindowï¼Œä¸éœ€è¦æˆ‘ä»¬å»ç®¡ç†ã€‚ç®€å•è¯´å°±æ˜¯å‡å¦‚ä»¥ A-&gt;B-&gt;C è¿™ä¸ªé¡ºåºå˜ä¸ºkeyWindowä¹‹åï¼ŒCé”€æ¯äº†ï¼ŒBä¼šè‡ªåŠ¨å˜ä¸ºkeyWindowã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦å»è°ƒç”¨<code class="highlighter-rouge">resignKeyWindow</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯ç”¨äºå­ç±»é‡å†™çš„ï¼Œæ‰‹åŠ¨è°ƒç”¨ä¹‹åï¼Œç»“æœä¹Ÿæ˜¯æœªçŸ¥çš„ã€‚</p>

<h4 id="uiwindow-6">7.æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªUIWindow</h4>

<p>è‹¹æœå®˜æ–¹æ˜¯è¿™ä¹ˆè¯´çš„ğŸ˜</p>
<blockquote>
  <p>Most apps need only one window, which displays the appâ€™s content on the deviceâ€™s main screen. You can create additional windows and display them on the deviceâ€™s main screen, but extra windows are more commonly used to display content on an attached external display.</p>
</blockquote>

<p>æ–°å»ºçš„UIWindowä¸€èˆ¬ç”¨äºå¤–æ¥çš„å±å¹•ï¼Œé‚£åœ¨æˆ‘ä»¬æ‰‹æœºçš„ä¸»å±å¹•ä»€ä¹ˆæ—¶å€™ä¼šæœ‰è¿™ç§éœ€æ±‚å‘¢ï¼Ÿæˆ‘è§‰å¾—ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä¸ªä¸€ä¸ªæ§ä»¶ï¼Œéœ€è¦ç‹¬ç«‹äºå…¶ä»–çš„view,å¹¶æ‚¬æµ®äºåº”ç”¨ç¨‹åºä¸­çš„æ—¶å€™ï¼Œä¹Ÿè®¸å°±éœ€è¦ç”¨åˆ°UIWindowäº†ï¼Œè¿™é‡Œæ‰€è°“çš„æ‚¬æµ®ï¼Œä¸è¿‡å°±æ˜¯windowLevelæ¯”è¾ƒé«˜ç½¢äº†ã€‚</p>

<p>å…¬å¸å·¥ç¨‹é‡Œæ‰€é›†æˆçš„æµ‹è¯•æ§ä»¶<a href="https://www.bugtags.com/">Bugtags</a>å°±æ˜¯åˆ©ç”¨UIWindowå®ç°çš„ï¼Œå¯ä»¥æ‚¬æµ®åœ¨ä»»æ„é¡µé¢ï¼Œä¸»è¦ç”¨äºæµ‹è¯•äººå‘˜æbugï¼Œç›´æ¥æ‰‹æœºä¸Šæbugã€‚å½“ç„¶æbugè¿™ä»¶äº‹å’Œæœ¬æ–‡å…³ç³»ä¸å¤§ï¼Œåœ¨æ­¤åªæ˜¯æƒ³è¡¨æ˜è¿™ç§æƒ…å†µå°±å¯ä»¥ç”¨UIWindowã€‚</p>

<h4 id="section">8.å…³äºæ‚¬æµ®çƒ</h4>
<p>å¯¹äºè¿™ä¸ªå¯æ‹‰æ‹½çš„æ‚¬æµ®çƒï¼Œæˆ‘ä¹Ÿæ¯”è¾ƒå¥½å¥‡ï¼Œæ‰€ä»¥è‡ªå·±ç€æ‰‹å®ç°äº†ä¸€ä¸‹ï¼ŒåŸç†ä¹ŸæŒºç®€å•ã€‚</p>

<ul>
  <li>åˆ›å»ºä¸€ä¸ªæŒ‰é’®å¤§å°çš„windowå¹¶æ˜¾ç¤º</li>
  <li>å°†å…¶windowLevelè®¾ç½®å¾—è¾ƒé«˜</li>
  <li>åœ¨æŒ‰é’®ä¸Šæ·»åŠ æ‹–æ‹½æ‰‹åŠ¿ï¼Œéšç€æ‰‹åŠ¿ç§»åŠ¨ï¼Œå¹¶æ·»åŠ ä¸€äº›è¾¹ç•Œæ§åˆ¶</li>
</ul>

<p>é‚£å°±æœ‰äººé—®äº†ï¼Œè¿™ä¸ªä¸œè¥¿æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>

<p>å› ä¸ºå…¬å¸çš„å·¥ç¨‹é‡Œç¡®å®æ²¡æœ‰ä»€ä¹ˆéœ€è¦éœ€è¦ç”¨åˆ°è¿™ä¸ªä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘åæ¥å‘ç°è¿™ä¸ªä¸œè¥¿è¿˜æ˜¯æœ‰é‚£ä¹ˆä¸€ç‚¹ç”¨ğŸ˜ã€‚ä¸è¿‡ä¸æ˜¯ç”¨åœ¨æ­£å¼ä»£ç ä¹‹ä¸­ï¼Œè€Œæ˜¯å¼€å‘æµ‹è¯•é˜¶æ®µã€‚</p>

<ul>
  <li>åšä¸ªä¸€é”®ç™»é™†åŠŸèƒ½ï¼ˆå…¬å¸çš„é¡¹ç›®å¼€å‘éœ€è¦é¢‘ç¹æ¢å·ï¼Œè¾“å¯†ç å¤ªéº»çƒ¦ï¼‰
    <ul>
      <li>å¦‚æœä¸ç”¨æ¢è´¦å·ï¼Œç›´æ¥å†™æ­»ä¸€ä¸ªè´¦å·ï¼Œç‚¹å‡»æ‚¬æµ®çƒç›´æ¥ç™»å½•</li>
      <li>å¦‚æœéœ€è¦é¢‘ç¹æ¢è´¦å·çš„ï¼Œå¯ä»¥æŠŠç™»å½•è¿‡çš„è´¦å·éƒ½è®°å½•ä¸‹æ¥ï¼Œå†™åˆ°NSUserDefaultsç­‰åœ°æ–¹ï¼Œä»¥åæ¯æ¬¡éœ€è¦ç™»é™†æ—¶ï¼Œç‚¹å‡»æµ®çƒï¼Œå‡ºæ¥ä¸€ä¸ªåˆ—è¡¨ï¼Œé€‰å…¶ä¸­ä¸€ä¸ªç™»é™†</li>
    </ul>
  </li>
  <li>ä¸€äº›è°ƒè¯•çš„æ—¶å€™æƒ³è¦åå¤æ‰§è¡Œçš„æŸå¥ä»£ç </li>
</ul>

<hr />
<p>âœ¨å…·ä½“ç»†èŠ‚å¯åˆ°GitHubä¸‹è½½demoæŸ¥çœ‹ã€‚<a href="https://github.com/ripperhe/ZYSuspensionView">GitHubåœ°å€ ğŸ˜</a>		
âœ¨å¦‚æœæœ‰ç”¨ï¼Œè¿˜æœ›æœ‹å‹èƒ½ç»™ä¸ªstarï¼Œè°¢è°¢ã€‚</p>


      <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">Run Faster</a> is maintained by <a href="https://github.com/ripperhe">ripper</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/pietromenna/jekyll-cayman-theme">Cayman theme</a> by <a href="http://github.com/jasonlong">Jason Long</a>.</span>
</footer>


    </section>

  </body>
</html>
